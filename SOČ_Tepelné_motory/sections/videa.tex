\section{Video}
{Jedním z nejdůležitějších výstupů mé práce je krátké výukové video; v této kapitole popíši a odůvodním svůj postup při jeho tvorbě. Video bude dostupné na platformě YouTube a také v plné kvalitě v přílohách zde:}
%\ref{pr:videoTepelneMotory}.}

\subsection{Předprodukce}
{Proces tvorby videa začal již před začátkem samotné 3D tvorby, nejprve jsem si stanovil cíle a vytvořil přibližný plán videa, který jsem poté rozšířil do scénáře.}\odst

\subsubsection{Cíl videa}
{Nejprve jsem si musel rozmyslet čeho se vlastně snažím dosáhnout; cílem mého videa je zábavně a dynamicky vysvětlit žákům látku tepelných motorů, video by zárověň nemělo být příliš dlouhé a mělo by být lehce vstřebatelné.}\odst
{Abych dosáhl tohoto cíle, musel jsem vytvořit rychlý, ale také dostatečně obsáhlý scénář, pomocí kterého lze účinně vysvětlit látka tepelných motorů. Samotný výklad by mohl působit nudně a nezajímavě, proto jsem pro zpestření využil 3D animaci. Snažil jsem se aby bylo video srozumitelné a zároveň žáky zaujalo.}

\subsubsection{Plánování a scénář}
{Video je celé synchronizované s hlasovým komentářem, toto načasování by mohla rozhodit i drobná změna intonace či tempa výkladu. 3D animace je velmi složitý a časově náročný proces, abych předešel opakování práce, vytvořil jsem nejprce detailní scénář, kterého se později budu muset pevně držet.}\odst
{Na tomto videu jsem s nikým nespolupracoval, můj scénář proto nemusel být psán ve formátu skutečných scénářů pro film či reklamu. Důležité bylo, abych mu dokázal porozumět já sám, proto mi postačil jednoduchý textový dokument s barevným zvýrazněním. K jeho vytvoření jsem použil \code{Google docs}.}

\newpage

\subsection{Produkce}
{V této kapitole je popsána samotná tvorba videa, ta probíhala téměř výhradně v prostředí softwaru \code{Blenderu}. Nejprve jsem nahrál hlasový doprovod, poté jsem vytvořil modely, které jsem následně rozhýbal a obarvil. Nakonec jsem vše vyrenderoval a připravil na postprodukci.}

\subsubsection{Hlasový doprovod}
{Hlasový doprovod je základem celého videa, řídí se dle něj veškeré vizuály. Logicky byl tedy první částí, na které jsem začal pracovat.}\odst
{Zvuk jsem nahrával se zapůjčeným mikrofonem RØDE VideoMic Rycote. Tento mikrofon nelze přímo připojit k počítači, proto jsem jako mezičlánek využil kameru JVS GC-PX100 BE. Vše jsem umístil na stativ, aby byl mikrofon v přívětivé pozici. Hotová sestava je na \obrref{obr:nahravaciSestava}.}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.08]{assets/images/MikrofonovaSestava.png}
    \caption{Nahrávací sestava \jaFoto}
    \label{obr:nahravaciSestava}
\end{figure}

{Dohromady jsem nahrál přibližně hodinové video, ze kterého jsem ponechal pouze zvukovou stopu, z té jsem odebral části kde bylo ticho nebo kde jsem udělal chybu při čtení scénáře; nakonec zbylo pouchý třiadvacet minut použitelného pro účely videa. V této části procesu jsem odhadoval, že video bude mít přibližně 8 minut. Scénář jsem tedy namluvil přibližně třikrát.}\odst
{Jelikož jsem nahrával v domácím prostředí, ve zvukové stopě šel slyšet šum. Tento šum jsem odebral pomocí softwaru \code{Audacity}, konkrétně jsem využil funkci \code{noise gate}.}\odst
{Naopak pro část kde odpočítávám start rakety jsem potřeboval zvuk degradovat, využil jsem opět software \code{Audacity}: přidal jsem šum, fázový posun a ozvěnu; omezil jsem vysoké a nízké frekvence a na závěr jsem snížil vzorkovací frekvenci na 8000.}

\newpage

\subsubsection{Modelování}
{Mimo 3D modely samotných motorů, jejichž tvorbu jsem vysvětlil v kapitole \scref{sc:animace}, jsem vytvořil i mnoho modelů pro dovysvětlení či vizuální zpestření, většinou jde o motory vozidel. V této kapitole vysvětlím 3D modelování ještě podrobněji.}\odst
{3D modelování je proces tvoření geometrie objektu, tedy modelu. Ty můžeme dělit na dva druhy: \textit{hard--surface} modely jsou charakterizovány ostrými hranami a pravidelnými tvary, zatímco \textit{soft--surface} modely obsahují organické a nepravidelné tvary. Většina mých modelů spadá do skupiny \textit{hard--surface}.}\odst
{Tvořit modely lze dvěma způsoby: destruktivní a nedestruktivní. Při destruktivním modelování měníme geometrii objektu přímo, posouváme body ve 3D prostoru a tím upravujeme tvar. Výhodou tohoto přístupu je jednoduchost a rychlost, nelze však změnit každý parametr. Nedestruktivní modelování spočívá ve tvorbě systémů které vytvoří geometrii, můžeme se proto kdykoliv vrátit a upravit jakoukoliv hodnotu, tento způsob je však velmi zdlouhavý a pro některé modely příliš nepraktický. Oba tyto způsoby mají své místo, pro většinu modelů jsem však zvolil destruktivní či kombinovaný přístup.}\odst
{Při tvorbě modelu velice pomůže předloha, ať už v podobě fotografií či technických plánků. Na \obrref{obr:predlohaFotky} je soubor referenčních obrázků pro tvorbu startovní plošiny pro raketu Saturn V organitovaný programem \code{PureRef}, \ref{obr:predlohaVykres} je technický výkres této plošiny.}

\begin{figure}[H]
    \centering
    \begingroup
    \makeatletter
    \renewcommand\thesubfigure{\thefigure~--~\@nameuse{subfiglabel@\alph{subfigure}}}
    \newcommand{\subfiglabel@a}{vlevo}
    \newcommand{\subfiglabel@b}{vpravo}
    \captionsetup[subfigure]{labelformat=simple, labelsep=colon}
    \renewcommand\p@subfigure{}
    \makeatother
    \begin{subfigure}{.7\textwidth}
        \centering
        \includegraphics[scale=.15]{assets/images/PureRef.png}
        \caption{Referenční obrázky pro tvorbu startovací plošiny, \\vytvořeno programem \code{PureRef}}
        \label{obr:predlohaFotky}
    \end{subfigure}%
    \begin{subfigure}{.3\textwidth}
        \centering
        \includegraphics[scale=.2]{assets/images/technickyVykresStartovaciPlosina.jpg}
        \caption{Technický výkres startovací plošiny}
        \label{obr:predlohaVykres}
    \end{subfigure}
    \endgroup
\end{figure}

{Po shromáždění obrázků začneme proces modelování, ten vysvětlím na modelu startovací plošiny. Nejprve si představíme, který základní tvar je nejbližší tvořenému objektu; v tomto případě je to krychle. Tuto krychli upravíme do přibližného tvaru startovací plošiny, pracujeme ve skutečném měřítku, aby nebyl objekt po \textit{importu} do hlavní scény správně velký v porovnání s ostatními objekty. K této krychli přidáme různé detaily, různé přístroje vytvoříme z menších krychlí a potrubí vytvoříme z válců.}

\newpage

{Abychom si usnadnili práci, využijeme osovou souměrnost plošiny a vytvoříme pouze půlku. Také díky scénáři víme, že bude tato plošina daleko od kamery a jakým úhlem bude natočena, nemusíme tedy ztrácet čas modelováním detailů, které nepůjdou vidět. Hotový model z pohledu kamery je na \obrref{obr:plosinaModel}, model ze zadní strany je na \obrref{obr:plosinaModelZezadu}.}

\begin{figure}[H]
    \centering
    \begingroup
    \makeatletter
    \renewcommand\thesubfigure{\thefigure~--~\@nameuse{subfiglabel@\alph{subfigure}}}
    \newcommand{\subfiglabel@a}{vlevo}
    \newcommand{\subfiglabel@b}{vpravo}
    \captionsetup[subfigure]{labelformat=simple, labelsep=colon}
    \renewcommand\p@subfigure{}
    \makeatother
    \begin{subfigure}{.48\textwidth}
        \centering
        \includegraphics[scale=.3]{assets/images/raketaPlatformaModel.png}
        \caption{Model startovací plošiny z \\pohledu kamery \jaObr}
        \label{obr:plosinaModel}
    \end{subfigure}
    \hfill
    \begin{subfigure}{.48\textwidth}
        \centering
        \includegraphics[scale=.3]{assets/images/raketaPlatformaModelZezadu.png}
        \caption{Model startovací plošiny \\zezadu \jaObr}
        \label{obr:plosinaModelZezadu}
    \end{subfigure}
    \endgroup
\end{figure}

{Model je dokončen, jeho kvalita je samozřejmě subjektivní, můžeme však hodnotit několik objektivních kritérií:}\odst 
{Měli bychom se snažit o ,,správnou'' topologii, obecně jde o to aby byl objekt tvořen přibližně stejně velkými čtyřúhelníky, důležitější je však aby nevznikaly žádné chyby při výpočtu stínů a aby se s modelem lehce pracovalo. Topologie startovací plošiny nevyjímečná.}\odst
{Další chybou jsou dvě plochy ve stejném místě, to vede k velice viditelnému artefaktu v podobě úplně černého místa. Tento problém nastal na věži startovací plošiny, kdy se některé tyče překrývaly. Jednoduchým řešením bylo posunout tyče o několik milimetrů, aby se plochy nepřekrývaly.}\odst
{Dále by měl model použít co nejméně bodů za zachování věrnosti předloze, velké množství bodů by mohlo vést ke zpomalení či naplnění paměti. Tato startovací plošina je tvořena dvěma sty tisíci body.}\odst
{Nejdůležitější je však jak model vypadá a zdali působí přesvědčivě jako předmět, který se snaží zobrazit.}

\newpage

\subsubsection{Materiály}
{Materiály ovládají, jak se světlo chová při interakci s objektem. Bez materiálu je startovací plošina šedá.}\odst
{Lze je tvořit dvěma způsoby: můžeme použít \textit{textury} (obrázky) a pokrýt jimi náš model. Tento způsob velice rychle docílí realistických výsledků, není však přizpůsobivý danému využití. Procedurální způsob naopak nabízí plnou kontrolu, tvoří ho jednoduché operace které dohromady říkají \code{Blenderu}, jak se má světlo chovat při interakci s objektem.}\odst
{Jelikož cílem tohoto projektu není věrná replikace skutečnosti a procedurální materiály jsou mi bližší, rozhodl jsem se je využít i pro tento projekt. Procedurální materiál se skládá z \textit{nodů} (uzly, které upravují parametry), které jsou do sebe vzájemně zapojeny. Existuje přes 80 \textit{nodů}, zde představím nejdůležitější z nich:}

\begin{itemize}
    \item \code{Principled BSDF}\par
        {Tento \textit{node} je srdcem většiny materiálů, patří do kategorie \textit{shaderů}, ty udávají jak se má světlo chovat. Umožňuje nastavit například barvu, kovovost, drsnost, průhlednost či normály (ty vytváří iluzi trojrozměrného povrchu bez přidání geometrie).}
    \item \code{Principled Volume}\par
        {Pokud jde o materiál plynu, využijeme tento \textit{shader}. Můžeme nastavit hustotu, barvu, anizotropie či záření plynu.}
    \item \code{Noise Texture}\par
        {Tento uzel patří mezi generující \textit{nody}. Generuje náhodný šum, můžeme upravit jeho velikost, detail, drsnost a vlnivost.}
    \item \code{Math Node}\par
        {Patří mezi upravující \textit{nody}, upravuje vstupní parametry pomocí různých aritmetických, trigonometrických a logických operací.}
    \item \code{Texture Coordinate}\par
        {Umožňuje přístup k datům geometrie; můžeme získat například souřadnice, normály či UV mapu (ta se používá pro mapování 2D obrázků na 3D povrch).}
\end{itemize}

{Materiály se tvoří v \textit{shader editoru}, v tomto okně přidáváme \textit{nody}, viz \obrref{obr:shaderEditor}.}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.45]{assets/images/shaderEditor.png}
    \caption{Tvorba materiálu v \textit{shader editoru} \jaObr}
    \label{obr:shaderEditor}
\end{figure}

\newpage

\subsubsection{Animace}
{Modely jsou hotové, ale statické. Pro jejich pohyb je třeba je animovat. Využil jsem klíčovou animaci, ta je založena na přídávání klíčových snímků. Klíčový snímek, neboli klíčová hodnota, obsahuje informace o tom, jakou hodnotu má mít daný parametr v daný čas. Můžeme tak nastavit pozici, rotaci a velikost objektů, upravit parametry jejich materiálů a další.}\odst
{Pro detailnější ovládání klíčových snímků jsem využil \code{graph editor}, ten umožňuje přesněji měnit časování a nuance pohybu, ukázka \code{graph editoru} je na \obrref{obr:grafEditor}.}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{assets/images/graphEditor.png}
    \caption{Zobrazení animace v \code{graph editoru} \jaObr}
    \label{obr:grafEditor}
\end{figure}

{Animace musela být synchronizována s komentářem, ten byl nastaven tak, aby se automaticky přehrával spolu s ní. Mimo klíčovou animaci jsem využil i procedurální animaci pomocí \textit{geometry nodes}. Tento přístup jsem zvolil pro jednoduché animace, které mohou být vyjádřeny předpisy. Například animace pístů, ojnic, hřídelí, ventilů atd. Tímto způsobem jsem vytvořil i povrch vody v části ,,Parní motory''.}\odst
{Posledním způsobem animace je simulace, tu jsem využil pro vytvoření fyzikálně založených objektů jako jsou například tuhá tělesa, částice, látky či plyny. Při tvorbě simulací je nutné správně nastavit vstupní hodnoty a poté nechat počítač simulaci vypočítat. Simulace často nevypadá tak jak bychom si ji představovali, proto upravíme parametry a proces opakujeme, dokud nejsou výsledky uspokojivé. Příklad simulace a parametrů naleznete na \obrref{obr:simulace}.}

\begin{figure}[H]
    \centering
    \begingroup
    \makeatletter
    \renewcommand\thesubfigure{\thefigure~--~\@nameuse{subfiglabel@\alph{subfigure}}}
    \newcommand{\subfiglabel@a}{vlevo}
    \newcommand{\subfiglabel@b}{vpravo}
    \captionsetup[subfigure]{labelformat=simple, labelsep=colon}
    \renewcommand\p@subfigure{}
    \makeatother
    \begin{subfigure}{0.35\textwidth}
        \centering
        \includegraphics[scale=0.3]{assets/images/simulaceParametry.png}
        \caption{Parametry simulace\\\jaObr}
    \end{subfigure}%
    \begin{subfigure}{0.6\textwidth}
        \centering
        \includegraphics[scale=0.6]{assets/images/simulaceVysledek.png}
        \caption{Výsledný simulace \jaObr}
    \end{subfigure}
    \endgroup
    \caption{Proces simulace v softwaru \code{Blender}}
    \label{obr:simulace}
\end{figure}

\newpage

\subsubsection{Skutečné záběry}
\hl{Tato část ještě nebyla nahrána.}\odst
{Abych propojil obsah videa se skutečností a tím poukázal na to, proč jsou tepelné motory důležité, rozhodl jsem se do videa přidat skutečné záběry. Záběry jsou pořízeny za jízdy z automobilu pomocí kamery \code{GoPro HERO12 Black}.}\odst
{Pro plynulý přehod mezi animací a živou částí jsem vytvořil v \code{Blenderu} plátno, na které se začnou promítat skutečné záběry. \code{Blender} camera se přiblíží a plynule se obraz změní na záběry ze skutečné kamery.}

\newpage

\subsubsection{Renderování}\label{sc:renderovani}
{Trojrozměrná scéna je pouze sbírka nejrůznějších hodnot jako jsou pozice objektů, jijch geometrie, textury, síla světel a nesmírně mnoho dalších. Tyto data se pomocí procesu zvaného renderování převedou na obrázky (což jsou vlastně také jen data). Počítač simuluje odrazy paprsků světla a jejich dopady na kameru, poté zaznamená barvu a intenzitu do hodnoty pixelu, na který světlo dopadlo. Konkrétně jsem využil \textit{path tracing} \textit{render engine} \code{Cycles}, který věrně mimikuje skutečné světlo.}\odst
{Pro správné renderování bylo zapotřebí nastavit hodnoty, se kterými bude počítač pracovat. Pokud bych je nastavil mírně, byl by výsledný obraz zrnitý nebo by obsahovat různé artefakty; naopak kdybych je nastavil příliš přísně, renderování by trvalo velice dlouho. Na základě vlastních zkušeností a experimentace jsem zvolil tyto hodnoty (jen nejdůležitější): }

\begin{itemize}
    \item {\code{Resolution} -- 1920x1080 (HD)}\par
        {Rozlišení výsledného videa, 1920x1080 je v současnosti jedno z nejrozšířenějších rozlišení. Pokud bych zvolil 2560x1440 či vyšší, čas renderování by se velice zvýšil.}
    \item {\code{Frame Rate} -- 24}\par
        {Počet snímků za sekundu videa, 24 je nejnižší standard který se používá.}
    \item {\code{Max Samples} -- 1024}\par
        {Nejvyšší počet paprsků, které dopadnou na jeden pixel. Výchozí hodnota je 4096, ta je však přemrštěná a pro mé účely prakticky nedosažitelná.}
    \item {\code{Persistent Data} -- Zapnuto}\par
        {Zachovává data v operační paměti, razantně zrychlí renderování na úkor zvýšeného využívání operační paměť (desítky GB).}
    \item {\code{View Transform} -- \code{AgX}}\par
        {Způsob, kterým se vyhodnotí barva pixelu. Hlavní předností \code{AgX} je vyblednutí světlých objektů, stejně jako u skutečných kamer.}
\end{itemize}

{Dobu renderování však nejvíce ovlivňuje použitý \textit{hardware}. Toto video jsem renderoval na velice výkonném pracovním počítači opatřeným grafickou kartou Nvidia RTX 4080, procesorem AMD 9 7900X a 32 GB operační paměti.}\odst
{Produktem renderování v tomto případě není video, ale tisíce obrázků formátu \code{exr}. Tento způsob ukládání přináší mnoho výhod: render může být přerušen, části videa mohou být zpětně upraveny bez nutnosti opakovaného renderování a je zachována vysoká kvalita.}

\newpage

{Do metadat obrázků jsem ukládal čas a paměť potřebnou k vykreslení snímku, pomocí vlastního programu napsaného v jazyce \code{Python} jsem vytvořil grafy, ty naleznete na \obrref{obr:grafRender}. Celé video se renderovalo desítky hodin.}

\begin{figure}[H]
    \centering
    \begin{subfigure}{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{assets/images/grafUvod.png}
        \caption{Graf času a paměti potřebné k renderování části ,,Úvod'' \jaGraf}\vspace{0.25cm}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \includegraphics[width=\textwidth]{assets/images/grafParniMotory.png}
        \caption{Graf času a paměti potřebné k renderování části ,,Parní motory'' \jaGraf}\vspace{0.25cm}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \includegraphics[width=\textwidth, height=3cm]{example-image-plain}
        \caption{Graf času a paměti potřebné k renderování části ,,Spalovací motory'' \jaGraf}\vspace{0.25cm}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \includegraphics[width=\textwidth, height=3cm]{example-image-plain}
        \caption{Graf času a paměti potřebné k renderování části ,,Reaktivní motory'' \jaGraf}\vspace{0.25cm}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
        \includegraphics[width=\textwidth, height=3cm]{example-image-plain}
        \caption{Graf času a paměti potřebné k renderování části ,,Závěr'' \jaGraf}
    \end{subfigure}
    \caption{Grafy času a paměti potřebné k renderování}
    \label{obr:grafRender}
\end{figure}

{Tyto grafy jsou užitečné pro určení výpočetně náročných částí, obecně je nejnáročnější renderovat plyny, velké množství bodů a složité geometrie (řádově statisíce bodů).}

\newpage

\subsection{Postprodukce}
\hl{Tato část ještě nebyla dokončena, v této kapitole popíši dokončování videa}

\subsubsection{Střih a kompozice}
\hl{Tato část ještě nebyla dokončena}

\subsubsection{Zvukový design}
\hl{Tato část ještě nebyla dokončena.}

\subsubsection{Export a distribuce}
\hl{Tato část ještě nebyla dokončena.}